density=c(25, 25), bty="n")
polygon(c(xbegin1, value30$x[poly_range1], xend1),                # X-Coordinates of polygon range
c(0, value30$y[poly_range1], 0),   density = 10, angle = 45,              # Y-Coordinates of polygon range
col = "blue",border = "black",lwd=.5)
polygon(c(xbegin2, value29$x[poly_range2], xend2),                # X-Coordinates of polygon range
c(0, value29$y[poly_range2], 0),   density = 10, angle = -45,              # Y-Coordinates of polygon range
col = "red",border = "black",lwd=.5)
axis(1, at = c(round(xbegin1,1), round(xbegin2,1), round(xend1,1), round(xend2,1)),
labels = c(rep("",4)),
cex.axis=.8, las = 2, tck=.015,
col.ticks  = "red", col.axis="red")
lablist1 <- c(round(xbegin1,1), round(xbegin2,1), round(xend1,1), round(xend2,1))
text(lablist1, par("usr")[3] - 0.02, labels = lablist1, srt = 45, pos = 1, xpd = TRUE, cex = .8, col = "red")
plot(value29,xlim=c(22.5,27), xaxt="n",
main = "29个一袋和30个一袋重量分布", ylab="密度", xlab="每袋扣件重量")
Axis(side=1, at=seq(22.5, 27, by = .5), las=2)
Axis(side=2, labels=FALSE)
lines(value30,col="black",lwd=1, ylim=c(0,1))
legend("topright", legend=c("30个一袋装95%概率区间", "29个一袋装95%概率区间"), fill=c("blue", "red"),
density=c(25, 25), bty="n")
polygon(c(xbegin1, value30$x[poly_range1], xend1),                # X-Coordinates of polygon range
c(0, value30$y[poly_range1], 0),   density = 10, angle = 45,              # Y-Coordinates of polygon range
col = "blue",border = "black",lwd=.5)
polygon(c(xbegin2, value29$x[poly_range2], xend2),                # X-Coordinates of polygon range
c(0, value29$y[poly_range2], 0),   density = 10, angle = -45,              # Y-Coordinates of polygon range
col = "red",border = "black",lwd=.5)
axis(1, at = c(round(xbegin1,1), round(xbegin2,1), round(xend1,1), round(xend2,1)),
labels = c(rep("",4)),
cex.axis=.8, las = 2, tck=.015,
col.ticks  = "red", col.axis="red")
lablist1 <- c(round(xbegin1,1), round(xbegin2,1), round(xend1,1), round(xend2,1))
text(lablist1, par("usr")[3] - 0.01, labels = lablist1, srt = 45, pos = 1, xpd = TRUE, cex = .8, col = "red")
plot(value29,xlim=c(22.5,27), xaxt="n",
main = "29个一袋和30个一袋重量分布", ylab="密度", xlab="每袋扣件重量")
Axis(side=1, at=seq(22.5, 27, by = .5), las=2)
Axis(side=2, labels=FALSE)
lines(value30,col="black",lwd=1, ylim=c(0,1))
legend("topright", legend=c("30个一袋装95%概率区间", "29个一袋装95%概率区间"), fill=c("blue", "red"),
density=c(25, 25), bty="n")
polygon(c(xbegin1, value30$x[poly_range1], xend1),                # X-Coordinates of polygon range
c(0, value30$y[poly_range1], 0),   density = 10, angle = 45,              # Y-Coordinates of polygon range
col = "blue",border = "black",lwd=.5)
polygon(c(xbegin2, value29$x[poly_range2], xend2),                # X-Coordinates of polygon range
c(0, value29$y[poly_range2], 0),   density = 10, angle = -30,              # Y-Coordinates of polygon range
col = "red",border = "black",lwd=.5)
axis(1, at = c(round(xbegin1,1), round(xbegin2,1), round(xend1,1), round(xend2,1)),
labels = c(rep("",4)),
cex.axis=.8, las = 2, tck=.015,
col.ticks  = "red", col.axis="red")
lablist1 <- c(round(xbegin1,1), round(xbegin2,1), round(xend1,1), round(xend2,1))
text(lablist1, par("usr")[3] - 0.01, labels = lablist1, srt = 45, pos = 1, xpd = TRUE, cex = .8, col = "red")
plot(value29,xlim=c(22.5,27), xaxt="n",
main = "29个一袋和30个一袋重量分布", ylab="密度", xlab="每袋扣件重量")
Axis(side=1, at=seq(22.5, 27, by = .5), las=2)
Axis(side=2, labels=FALSE)
lines(value30,col="black",lwd=1, ylim=c(0,1))
legend("topright", legend=c("30个一袋装95%概率区间", "29个一袋装95%概率区间"), fill=c("blue", "red"),
density=c(25, 25), bty="n")
polygon(c(xbegin1, value30$x[poly_range1], xend1),                # X-Coordinates of polygon range
c(0, value30$y[poly_range1], 0),   density = 10, angle = 45,              # Y-Coordinates of polygon range
col = "blue",border = "black",lwd=.5)
polygon(c(xbegin2, value29$x[poly_range2], xend2),                # X-Coordinates of polygon range
c(0, value29$y[poly_range2], 0),   density = 10, angle = -30,              # Y-Coordinates of polygon range
col = "red",border = "black",lwd=.5)
axis(1, at = c(round(xbegin1,1), round(xbegin2,1), round(xend1,1), round(xend2,1)),
labels = c(rep("",4)),
cex.axis=.8, las = 2, tck=.015,
col.ticks  = "red", col.axis="red")
lablist1 <- c(round(xbegin1,1), round(xbegin2,1), round(xend1,1), round(xend2,1))
text(lablist1, par("usr")[3] - 0, labels = lablist1, srt = 45, pos = 1, xpd = TRUE, cex = .8, col = "red")
plot(value29,xlim=c(22.5,27), xaxt="n",
main = "29个一袋和30个一袋重量分布", ylab="密度", xlab="每袋扣件重量")
Axis(side=1, at=seq(22.5, 27, by = .5), las=2)
Axis(side=2, labels=FALSE)
lines(value30,col="black",lwd=1, ylim=c(0,1))
legend("topright", legend=c("30个一袋装95%概率区间", "29个一袋装95%概率区间"), fill=c("blue", "red"),
density=c(25, 25), bty="n")
polygon(c(xbegin1, value30$x[poly_range1], xend1),                # X-Coordinates of polygon range
c(0, value30$y[poly_range1], 0),   density = 10, angle = 45,              # Y-Coordinates of polygon range
col = "blue",border = "black",lwd=.5)
polygon(c(xbegin2, value29$x[poly_range2], xend2),                # X-Coordinates of polygon range
c(0, value29$y[poly_range2], 0),   density = 10, angle = -30,              # Y-Coordinates of polygon range
col = "red",border = "black",lwd=.5)
axis(1, at = c(round(xbegin1,1), round(xbegin2,1), round(xend1,1), round(xend2,1)),
labels = c(rep("",4)),
cex.axis=.8, las = 2, tck=.015,
col.ticks  = "red", col.axis="red")
lablist1 <- c(round(xbegin1,1), round(xbegin2,1), round(xend1,1), round(xend2,1))
text(lablist1, par("usr")[3] - 0, labels = lablist1, srt = 0, pos = 1, xpd = TRUE, cex = .8, col = "red")
plot(value29,xlim=c(22.5,27), xaxt="n",
main = "29个一袋和30个一袋重量分布", ylab="密度", xlab="每袋扣件重量")
Axis(side=1, at=seq(22.5, 27, by = .5), las=2)
Axis(side=2, labels=FALSE)
lines(value30,col="black",lwd=1, ylim=c(0,1))
legend("topright", legend=c("30个一袋装95%概率区间", "29个一袋装95%概率区间"), fill=c("blue", "red"),
density=c(25, 25), bty="n")
polygon(c(xbegin1, value30$x[poly_range1], xend1),                # X-Coordinates of polygon range
c(0, value30$y[poly_range1], 0),   density = 10, angle = 45,              # Y-Coordinates of polygon range
col = "blue",border = "black",lwd=.5)
polygon(c(xbegin2, value29$x[poly_range2], xend2),                # X-Coordinates of polygon range
c(0, value29$y[poly_range2], 0),   density = 10, angle = -30,              # Y-Coordinates of polygon range
col = "red",border = "black",lwd=.5)
axis(1, at = c(round(xbegin1,1), round(xbegin2,1), round(xend1,1), round(xend2,1)),
labels = c(rep("",4)),
cex.axis=.8, las = 2, tck=.015,
col.ticks  = "red", col.axis="red")
lablist1 <- c(round(xbegin1,1), round(xbegin2,1), round(xend1,1), round(xend2,1))
text(lablist1, par("usr")[3] + 0.01, labels = lablist1, srt = 0, pos = 1, xpd = TRUE, cex = .8, col = "red")
plot(value29,xlim=c(22.5,27), xaxt="n",
main = "29个一袋和30个一袋重量分布", ylab="密度", xlab="每袋扣件重量")
Axis(side=1, at=seq(22.5, 27, by = .5), las=0)
Axis(side=2, labels=FALSE)
lines(value30,col="black",lwd=1, ylim=c(0,1))
legend("topright", legend=c("30个一袋装95%概率区间", "29个一袋装95%概率区间"), fill=c("blue", "red"),
density=c(25, 25), bty="n")
polygon(c(xbegin1, value30$x[poly_range1], xend1),                # X-Coordinates of polygon range
c(0, value30$y[poly_range1], 0),   density = 10, angle = 45,              # Y-Coordinates of polygon range
col = "blue",border = "black",lwd=.5)
polygon(c(xbegin2, value29$x[poly_range2], xend2),                # X-Coordinates of polygon range
c(0, value29$y[poly_range2], 0),   density = 10, angle = -30,              # Y-Coordinates of polygon range
col = "red",border = "black",lwd=.5)
axis(1, at = c(round(xbegin1,1), round(xbegin2,1), round(xend1,1), round(xend2,1)),
labels = c(rep("",4)),
cex.axis=.8, las = 2, tck=.015,
col.ticks  = "red", col.axis="red")
lablist1 <- c(round(xbegin1,1), round(xbegin2,1), round(xend1,1), round(xend2,1))
text(lablist1, par("usr")[3] + 0.01, labels = lablist1, srt = 0, pos = 1, xpd = TRUE, cex = .8, col = "red")
axis(1, at = setdiff(cx, seq(22.5, 27, by = .5)), labels = NA)
plot(value29,xlim=c(22.5,27), xaxt="n",
main = "29个一袋和30个一袋重量分布", ylab="密度", xlab="每袋扣件重量")
Axis(side=1, at=seq(22.5, 27, by = .5), las=0)
Axis(side=2, labels=FALSE)
lines(value30,col="black",lwd=1, ylim=c(0,1))
legend("topright", legend=c("30个一袋装95%概率区间", "29个一袋装95%概率区间"), fill=c("blue", "red"),
density=c(25, 25), bty="n")
polygon(c(xbegin1, value30$x[poly_range1], xend1),                # X-Coordinates of polygon range
c(0, value30$y[poly_range1], 0),   density = 10, angle = 45,              # Y-Coordinates of polygon range
col = "blue",border = "black",lwd=.5)
polygon(c(xbegin2, value29$x[poly_range2], xend2),                # X-Coordinates of polygon range
c(0, value29$y[poly_range2], 0),   density = 10, angle = -30,              # Y-Coordinates of polygon range
col = "red",border = "black",lwd=.5)
axis(1, at = c(round(xbegin1,1), round(xbegin2,1)),
labels = c(rep("",2)),
cex.axis=.8, las = 2, tck=.015,
col.ticks  = "red", col.axis="red")
axis(1, at = c(round(xend1,1), round(xend2,1)),
labels = NA,
cex.axis=.8, las = 2, tck=.015,
col.ticks  = "blue", col.axis="red")
plot(value29,xlim=c(22.5,27), xaxt="n",
main = "29个一袋和30个一袋重量分布", ylab="密度", xlab="每袋扣件重量")
Axis(side=1, at=seq(22.5, 27, by = .5), las=0)
Axis(side=2, labels=FALSE)
lines(value30,col="black",lwd=1, ylim=c(0,1))
legend("topright", legend=c("30个一袋装95%概率区间", "29个一袋装95%概率区间"), fill=c("blue", "red"),
density=c(25, 25), bty="n")
polygon(c(xbegin1, value30$x[poly_range1], xend1),                # X-Coordinates of polygon range
c(0, value30$y[poly_range1], 0),   density = 10, angle = 45,              # Y-Coordinates of polygon range
col = "blue",border = "black",lwd=.5)
polygon(c(xbegin2, value29$x[poly_range2], xend2),                # X-Coordinates of polygon range
c(0, value29$y[poly_range2], 0),   density = 10, angle = -30,              # Y-Coordinates of polygon range
col = "red",border = "black",lwd=.5)
axis(1, at = c(round(xbegin1,1),round(xend1,1) ),
labels = c(rep("",2)),
cex.axis=.8, las = 2, tck=.015,
col.ticks  = "red", col.axis="red")
plot(value29,xlim=c(22.5,27), xaxt="n",
main = "29个一袋和30个一袋重量分布", ylab="密度", xlab="每袋扣件重量")
Axis(side=1, at=seq(22.5, 27, by = .5), las=0)
Axis(side=2, labels=FALSE)
lines(value30,col="black",lwd=1, ylim=c(0,1))
legend("topright", legend=c("30个一袋装95%概率区间", "29个一袋装95%概率区间"), fill=c("blue", "red"),
density=c(25, 25), bty="n")
polygon(c(xbegin1, value30$x[poly_range1], xend1),                # X-Coordinates of polygon range
c(0, value30$y[poly_range1], 0),   density = 10, angle = 45,              # Y-Coordinates of polygon range
col = "blue",border = "black",lwd=.5)
polygon(c(xbegin2, value29$x[poly_range2], xend2),                # X-Coordinates of polygon range
c(0, value29$y[poly_range2], 0),   density = 10, angle = -30,              # Y-Coordinates of polygon range
col = "red",border = "black",lwd=.5)
axis(1, at = c(round(xbegin1,1),round(xend1,1) ),
labels = c(rep("",2)),
cex.axis=.8, las = 2, tck=.015,
col.ticks  = "blue", col.axis="red")
axis(1, at = c(round(xbegin2,1) round(xend2,1)),
labels = NA,
cex.axis=.8, las = 2, tck=.015,
col.ticks  = "red", col.axis="red")
axis(1, at = c(round(xbegin2,1) round(xend2,1)),
labels = c(rep("",4)),
cex.axis=.8, las = 2, tck=.015,
col.ticks  = "red", col.axis="red")
axis(1, at = c(round(xbegin2,1) round(xend2,1)),
labels = c(rep("",2)),
cex.axis=.8, las = 2, tck=.015,
col.ticks  = "red", col.axis="red")
axis(1, at = c(round(xbegin2,1), round(xend2,1)),
labels = c(rep("",2)),
cex.axis=.8, las = 2, tck=.015,
col.ticks  = "red", col.axis="red")
polygon(c(xbegin6, value7$x[poly_range6], xend6),                # X-Coordinates of polygon range
c(0, value7$y[poly_range6], 0),               # Y-Coordinates of polygon range
col = redtrans, border = "black",lwd=.5)
value7 <- density(sample1000_7$weight)
value6 <- density(sample1000_6$weight)
value5 <- density(sample1000_5$weight)
value4 <- density(sample1000_4$weight)
### **原始数据分布**
```{r , echo=FALSE}
sample1000_7<-data.frame(time=1:1000,mean=0,var=0,weight=0)
for (i in 1:1000){
sample1000_7$mean[i] <- mean(sample(kj$weight,7,F))
sample1000_7$var[i] <- var(sample(kj$weight,7,F))
sample1000_7$weight[i] <- sum(sample(kj$weight,7,F))
}
sample1000_6<-data.frame(time=1:1000,mean=0,var=0,weight=0)
for (i in 1:1000){
sample1000_6$mean[i] <- mean(sample(kj$weight,6,F))
sample1000_6$var[i] <- var(sample(kj$weight,6,F))
sample1000_6$weight[i] <- sum(sample(kj$weight,6,F))
}
sample1000_5<-data.frame(time=1:1000,mean=0,var=0,weight=0)
for (i in 1:1000){
sample1000_5$mean[i] <- mean(sample(kj$weight,5,F))
sample1000_5$var[i] <- var(sample(kj$weight,5,F))
sample1000_5$weight[i] <- sum(sample(kj$weight,5,F))
}
sample1000_4<-data.frame(time=1:1000,mean=0,var=0,weight=0)
for (i in 1:1000){
sample1000_4$mean[i] <- mean(sample(kj$weight,4,F))
sample1000_4$var[i] <- var(sample(kj$weight,4,F))
sample1000_4$weight[i] <- sum(sample(kj$weight,4,F))
}
value7 <- density(sample1000_7$weight)
value6 <- density(sample1000_6$weight)
value5 <- density(sample1000_5$weight)
value4 <- density(sample1000_4$weight)
plot(value4,xlim=c(2.9,7))
##7个一袋样本2个标准差阴影
xbegin6 <- mean(sample1000_7$weight)-2*sd(sample1000_7$weight)
xend6 <- mean(sample1000_7$weight)+2*sd(sample1000_7$weight)
redtrans <- rgb(255, 0, 0, 127, maxColorValue=255)
poly_range6 <- value7$x >= xbegin6 & value7$x <= xend6
polygon(c(xbegin6, value7$x[poly_range6], xend6),                # X-Coordinates of polygon range
c(0, value7$y[poly_range6], 0),               # Y-Coordinates of polygon range
col = redtrans, border = "black",lwd=.5)
##6个一袋样本2个标准差阴影
xbegin7 <- mean(sample1000_6$weight)-2*sd(sample1000_6$weight)
xend7 <- mean(sample1000_6$weight)+2*sd(sample1000_6$weight)
poly_range7 <- value6$x >= xbegin7 & value6$x <= xend7
polygon(c(xbegin7, value6$x[poly_range7], xend7),                # X-Coordinates of polygon range
c(0, value6$y[poly_range7], 0),              # Y-Coordinates of polygon range
col = "blue",border = "black",lwd=.5)
polygon(c(xbegin7, value6$x[poly_range7], xend7),                # X-Coordinates of polygon range
c(0, value6$y[poly_range7], 0),              # Y-Coordinates of polygon range
col = "#00FF0022",border = "black",lwd=.5)
##5个一袋样本2个标准差阴影
xbegin8 <- mean(sample1000_5$weight)-2*sd(sample1000_5$weight)
xend8 <- mean(sample1000_5$weight)+2*sd(sample1000_5$weight)
poly_range8 <- value5$x >= xbegin8 & value5$x <= xend8
polygon(c(xbegin8, value5$x[poly_range8], xend8),                # X-Coordinates of polygon range
c(0, value5$y[poly_range8], 0),               # Y-Coordinates of polygon range
col = "#FF000022",border = "black",lwd=.5)
##4个一袋样本2个标准差阴影
xbegin9 <- mean(sample1000_4$weight)-2*sd(sample1000_4$weight)
xend9 <- mean(sample1000_4$weight)+2*sd(sample1000_4$weight)
poly_range9 <- value5$x >= xbegin9 & value4$x <= xend9
polygon(c(xbegin9, value4$x[poly_range9], xend9),                # X-Coordinates of polygon range
c(0, value4$y[poly_range9], 0),               # Y-Coordinates of polygon range
col = "#00FF0022",border = "black",lwd=.5)
plot(value4,xlim=c(2.9,7))
##7个一袋样本2个标准差阴影
xbegin6 <- mean(sample1000_7$weight)-2*sd(sample1000_7$weight)
xend6 <- mean(sample1000_7$weight)+2*sd(sample1000_7$weight)
redtrans <- rgb(255, 0, 0, 127, maxColorValue=255)
poly_range6 <- value7$x >= xbegin6 & value7$x <= xend6
polygon(c(xbegin6, value7$x[poly_range6], xend6),                # X-Coordinates of polygon range
c(0, value7$y[poly_range6], 0),               # Y-Coordinates of polygon range
col = #0000FF22, border = "black",lwd=.5)
##6个一袋样本2个标准差阴影
xbegin7 <- mean(sample1000_6$weight)-2*sd(sample1000_6$weight)
xend7 <- mean(sample1000_6$weight)+2*sd(sample1000_6$weight)
poly_range7 <- value6$x >= xbegin7 & value6$x <= xend7
polygon(c(xbegin7, value6$x[poly_range7], xend7),                # X-Coordinates of polygon range
c(0, value6$y[poly_range7], 0),              # Y-Coordinates of polygon range
col = "#00FF0022",border = "black",lwd=.5)
##5个一袋样本2个标准差阴影
xbegin8 <- mean(sample1000_5$weight)-2*sd(sample1000_5$weight)
xend8 <- mean(sample1000_5$weight)+2*sd(sample1000_5$weight)
poly_range8 <- value5$x >= xbegin8 & value5$x <= xend8
polygon(c(xbegin8, value5$x[poly_range8], xend8),                # X-Coordinates of polygon range
c(0, value5$y[poly_range8], 0),               # Y-Coordinates of polygon range
col = "#FF000022",border = "black",lwd=.5)
##4个一袋样本2个标准差阴影
xbegin9 <- mean(sample1000_4$weight)-2*sd(sample1000_4$weight)
xend9 <- mean(sample1000_4$weight)+2*sd(sample1000_4$weight)
poly_range9 <- value5$x >= xbegin9 & value4$x <= xend9
polygon(c(xbegin9, value4$x[poly_range9], xend9),                # X-Coordinates of polygon range
c(0, value4$y[poly_range9], 0),               # Y-Coordinates of polygon range
col = "#00FF0022",border = "black",lwd=.5)
plot(value4,xlim=c(2.9,7))
polygon(c(xbegin6, value7$x[poly_range6], xend6),                # X-Coordinates of polygon range
c(0, value7$y[poly_range6], 0),               # Y-Coordinates of polygon range
col = #0000FF22, border = "black",lwd=.5)
polygon(c(xbegin6, value7$x[poly_range6], xend6),                # X-Coordinates of polygon range
c(0, value7$y[poly_range6], 0),               # Y-Coordinates of polygon range
col ="#0000FF22", border = "black",lwd=.5)
poly_range6 <- value7$x >= xbegin6 & value7$x <= xend6
polygon(c(xbegin6, value7$x[poly_range6], xend6),                # X-Coordinates of polygon range
c(0, value7$y[poly_range6], 0),               # Y-Coordinates of polygon range
col ="#0000FF22", border = "black",lwd=.5)
polygon(c(xbegin7, value6$x[poly_range7], xend7),                # X-Coordinates of polygon range
c(0, value6$y[poly_range7], 0),              # Y-Coordinates of polygon range
col = "#00FF0022",border = "black",lwd=.5)
polygon(c(xbegin8, value5$x[poly_range8], xend8),                # X-Coordinates of polygon range
c(0, value5$y[poly_range8], 0),               # Y-Coordinates of polygon range
col = "#FF000022",border = "black",lwd=.5)
polygon(c(xbegin9, value4$x[poly_range9], xend9),                # X-Coordinates of polygon range
c(0, value4$y[poly_range9], 0),               # Y-Coordinates of polygon range
col = "#00FF0022",border = "black",lwd=.5)
rgb(t(col2rgb("red"))/255)
polygon(c(xbegin9, value4$x[poly_range9], xend9),                # X-Coordinates of polygon range
c(0, value4$y[poly_range9], 0),               # Y-Coordinates of polygon range
col = "#RRGGBBAA",border = "black",lwd=.5)
library(readxl)
kj <- read_excel("E:/R/新建文件夹/十字扣件重量.xlsx",sheet="Sheet2")
hist(kj$weight,breaks = 20,col = "red",freq = T,
xlab="扣件重量/KG",ylab = "频数",main = "扣件重量频数分布直方图",
xlim=c(0.6,1.2))
##添加轴须图
rug(jitter(kj$weight))
lines(density(kj$weight),col="blue",lwd=2)
legend("topright",legend = c("核密度曲线"),col = "blue",lty = 1,lwd = 2)
box()
hist(kj$weight,breaks = 20,col = "red",freq = F,
xlab="扣件重量/KG",ylab = "密度",main = "扣件重量分布",
xlim=c(0.6,1.2))
##添加轴须图
rug(jitter(kj$weight))
lines(density(kj$weight),col="blue",lwd=2)
legend("topright",legend = c("核密度曲线"),col = "blue",lty = 1,lwd = 2)
box()
library(sm)
sm.density.compare(kj$weight,kj$group,col=c(1:6),lty=1:6,lwd=2,xlab="扣件重量/KG",ylab="密度")
title(main = "每袋扣件核密度曲线")
group <- factor(kj$group,levels = c(1:6),
labels = c("第1袋","第2袋","第3袋",
"第4袋","第5袋","第6袋"))
colfill <- c(1:6)
legend("topright",levels(group),col = colfill,lty = 1:6,lwd = 2,
x.intersp=1,y.intersp=1, cex = 1)
##构建样本
set.seed(1234)
##抽样，样本容量30、29
sample1000_30 <- data.frame(time=1:1000,mean=0,var=0,weight=0)
sample1000_29 <- data.frame(time=1:1000,mean=0,var=0,weight=0)
for (i in 1:1000){
sample1000_30$mean[i] <- mean(sample(kj$weight,30,F))
sample1000_30$var[i] <- var(sample(kj$weight,30,F))
sample1000_30$weight[i] <- sum(sample(kj$weight,30,F))
}
for (i in 1:1000){
sample1000_29$mean[i] <- mean(sample(kj$weight,29,F))
sample1000_29$var[i] <- var(sample(kj$weight,29,F))
sample1000_29$weight[i] <- sum(sample(kj$weight,29,F))
}
##获得密度曲线XY值
value30 <- density(sample1000_30$weight)
value29 <- density(sample1000_29$weight)
##绘图
plot(value29,xlim=c(22.5,27), xaxt="n",
main = "29个一袋和30个一袋重量分布", ylab="密度", xlab="每袋扣件重量/kg")
Axis(side=1,at=seq(22.5, 27, by = .5),las=0)
Axis(side=2, labels=FALSE)
lines(value30,col="black",lwd=1, ylim=c(0,1))
legend("topright", legend=c("30个一袋装重量95%概率区间", "29个一袋装重量95%概率区间"),
fill=c(rgb(255, 191, 132, 127, maxColorValue = 255), rgb(254, 148, 148, 127, maxColorValue = 255)), bty="n")
##求30个一袋2个标准差的值域
xbegin1 <- mean(sample1000_30$weight)-2*sd(sample1000_30$weight)
xend1 <- mean(sample1000_30$weight)+2*sd(sample1000_30$weight)
poly_range1 <- value30$x >= xbegin1 & value30$x <= xend1
polygon(c(xbegin1, value30$x[poly_range1], xend1),                # X-Coordinates of polygon range
c(0, value30$y[poly_range1], 0),              # Y-Coordinates of polygon range
col = rgb(255, 191, 132, 127, maxColorValue = 255), border = "black",lwd=.5)
##求29个一袋2个标准差的值域
xbegin2 <- mean(sample1000_29$weight)-2*sd(sample1000_29$weight)
xend2 <- mean(sample1000_29$weight)+2*sd(sample1000_29$weight)
poly_range2 <- value29$x >= xbegin2 & value29$x <= xend2
polygon(c(xbegin2, value29$x[poly_range2], xend2),                # X-Coordinates of polygon range
c(0, value29$y[poly_range2], 0),                # Y-Coordinates of polygon range
col = rgb(254, 148, 148, 127, maxColorValue = 255),border = "black",lwd=.5)
axis(1, at = c(round(xbegin1,1),round(xend1,1) ),
labels = c(rep("",2)),
cex.axis=.8, las = 2, tck=.015,
col.ticks  = rgb(255, 191, 132, 127, maxColorValue = 255), col.axis="red")
axis(1, at = c(round(xbegin2,1), round(xend2,1)),
labels = c(rep("",2)),
cex.axis=.8, las = 2, tck=.015,
col.ticks  = rgb(254, 148, 148, 127, maxColorValue = 255), col.axis="red")
lablist1 <- c(round(xbegin1,1), round(xbegin2,1), round(xend1,1), round(xend2,1))
text(lablist1, par("usr")[3] + 0.01, labels = lablist1, srt = 0, pos = 1, xpd = TRUE, cex = .8,
col = c(rgb(255, 191, 132, maxColorValue = 255),
rgb(254, 148, 148, maxColorValue = 255),
rgb(255, 191, 132, maxColorValue = 255),
rgb(254, 148, 148, maxColorValue = 255)))
lines(c(24.2,25.3), c(0,0), col = "red", lwd = 1.5)
sample1000_7<-data.frame(time=1:1000,mean=0,var=0,weight=0)
for (i in 1:1000){
sample1000_7$mean[i] <- mean(sample(kj$weight,7,F))
sample1000_7$var[i] <- var(sample(kj$weight,7,F))
sample1000_7$weight[i] <- sum(sample(kj$weight,7,F))
}
sample1000_6<-data.frame(time=1:1000,mean=0,var=0,weight=0)
for (i in 1:1000){
sample1000_6$mean[i] <- mean(sample(kj$weight,6,F))
sample1000_6$var[i] <- var(sample(kj$weight,6,F))
sample1000_6$weight[i] <- sum(sample(kj$weight,6,F))
}
sample1000_5<-data.frame(time=1:1000,mean=0,var=0,weight=0)
for (i in 1:1000){
sample1000_5$mean[i] <- mean(sample(kj$weight,5,F))
sample1000_5$var[i] <- var(sample(kj$weight,5,F))
sample1000_5$weight[i] <- sum(sample(kj$weight,5,F))
}
sample1000_4<-data.frame(time=1:1000,mean=0,var=0,weight=0)
for (i in 1:1000){
sample1000_4$mean[i] <- mean(sample(kj$weight,4,F))
sample1000_4$var[i] <- var(sample(kj$weight,4,F))
sample1000_4$weight[i] <- sum(sample(kj$weight,4,F))
}
value7 <- density(sample1000_7$weight)
value6 <- density(sample1000_6$weight)
value5 <- density(sample1000_5$weight)
value4 <- density(sample1000_4$weight)
plot(value4,xlim=c(2.9,7),
main = "不同装袋数重量分布", ylab="密度", xlab="每袋扣件重量/kg")
legend("topright", legend=c("7个一袋装重量95%概率区间", "6个一袋装重量95%概率区间",
"5个一袋装重量95%概率区间", "4个一袋装重量95%概率区间"),
fill=c(rgb(255, 191, 132, 127, maxColorValue = 255),
rgb(254, 148, 148, 127, maxColorValue = 255),
rgb(116, 208, 147, 127, maxColorValue = 255),
rgb(120, 187, 219, 127, maxColorValue = 255)), bty="n")
##7个一袋样本2个标准差阴影
xbegin6 <- mean(sample1000_7$weight)-2*sd(sample1000_7$weight)
xend6 <- mean(sample1000_7$weight)+2*sd(sample1000_7$weight)
redtrans <- rgb(255, 0, 0, 127, maxColorValue=255)
poly_range6 <- value7$x >= xbegin6 & value7$x <= xend6
polygon(c(xbegin6, value7$x[poly_range6], xend6),                # X-Coordinates of polygon range
c(0, value7$y[poly_range6], 0),             # Y-Coordinates of polygon range
col = rgb(255, 191, 132, 127, maxColorValue = 255),border = "black",lwd=.5)
##6个一袋样本2个标准差阴影
xbegin7 <- mean(sample1000_6$weight)-2*sd(sample1000_6$weight)
xend7 <- mean(sample1000_6$weight)+2*sd(sample1000_6$weight)
poly_range7 <- value6$x >= xbegin7 & value6$x <= xend7
polygon(c(xbegin7, value6$x[poly_range7], xend7),                # X-Coordinates of polygon range
c(0, value6$y[poly_range7], 0),             # Y-Coordinates of polygon range
col = rgb(254, 148, 148, 127, maxColorValue = 255),border = "black",lwd=.5)
##5个一袋样本2个标准差阴影
xbegin8 <- mean(sample1000_5$weight)-2*sd(sample1000_5$weight)
xend8 <- mean(sample1000_5$weight)+2*sd(sample1000_5$weight)
poly_range8 <- value5$x >= xbegin8 & value5$x <= xend8
polygon(c(xbegin8, value5$x[poly_range8], xend8),                # X-Coordinates of polygon range
c(0, value5$y[poly_range8], 0),              # Y-Coordinates of polygon range
col = rgb(116, 208, 147, 127, maxColorValue = 255),border = "black",lwd=.5)
##4个一袋样本2个标准差阴影
xbegin9 <- mean(sample1000_4$weight)-2*sd(sample1000_4$weight)
xend9 <- mean(sample1000_4$weight)+2*sd(sample1000_4$weight)
poly_range9 <- value5$x >= xbegin9 & value4$x <= xend9
polygon(c(xbegin9, value4$x[poly_range9], xend9),                # X-Coordinates of polygon range
c(0, value4$y[poly_range9], 0),              # Y-Coordinates of polygon range
col = rgb(120, 187, 219, 127, maxColorValue = 255),border = "black",lwd=.5)
lines(value7,col="BLACK",lwd=1, ylim=c(0,1))
View(kj)
average(kj$weight)
sum(kj$weight)/180
25.2-0.84
0.84*29
install.packages("eoffice")
install.packages("eoffice")
install.packages("ABC",repos="http://mirror.bjtu.edu.cn/ ")
install.packages("eoffice")
install.packages("ABC",repos="http://mirror.bjtu.edu.cn/ ")
options("repos" = c(CRAN="https://mirrors.tuna.tsinghua.edu.cn/CRAN/"))
install.packages("eoffice")
library(eoffice)
hist(kj$weight,breaks = 20,col = "red",freq = T,
xlab="扣件重量/KG",ylab = "频数",main = "扣件重量分布",
xlim=c(0.6,1.2))
rug(jitter(kj$weight))
lines(density(kj$weight),col="blue",lwd=2)
legend("topright",legend = c("核密度曲线"),col = "blue",lty = 1,lwd = 2)
box()
##指定组数和颜色
p <- hist(kj$weight,breaks = 20,col = "red",freq = T,
xlab="扣件重量/KG",ylab = "频数",main = "扣件重量分布",
xlim=c(0.6,1.2))
##添加轴须图
p <- p +rug(jitter(kj$weight))
p <- hist(kj$weight,breaks = 20,col = "red",freq = T,
xlab="扣件重量/KG",ylab = "频数",main = "扣件重量分布",
xlim=c(0.6,1.2))
p <- p + rug(jitter(kj$weight))
p <- p + lines(density(kj$weight),col="blue",lwd=2) +
legend("topright",legend = c("核密度曲线"),col = "blue",lty = 1,lwd = 2) + box()
##添加轴须图
rug(jitter(kj$weight))
lines(density(kj$weight),col="blue",lwd=2)
legend("topright",legend = c("核密度曲线"),col = "blue",lty = 1,lwd = 2)
box()
topptx(p,filename = "p.pptx",width = 6,height = 4)
setwd('E:/R/新建文件夹/【批量下载】Sankey等/我的资源/桑基图')
topptx(p,filename = "p.pptx",width = 6,height = 4)
version
